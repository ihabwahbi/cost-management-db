# Pre-commit hooks for cost-management-db
# Install: pip install pre-commit && pre-commit install
# Manual run: pre-commit run --all-files

repos:
  - repo: local
    hooks:
      # Regenerate pipeline map when pipeline-related files change
      - id: update-pipeline-map
        name: Update Pipeline Map
        entry: python3 scripts/generate_pipeline_map.py
        language: system
        files: ^scripts/(stage[123]_|config/).*\.py$|^src/schema/.*\.ts$
        pass_filenames: false
        stages: [pre-commit]
      
      # Regenerate Context Oracle artifacts when source files change
      - id: update-context-oracle
        name: Update Context Oracle
        entry: python3 scripts/generate_context_oracle.py --skip-pipeline-map
        language: system
        files: ^scripts/(stage[123]_|config/).*\.py$|^src/schema/.*\.ts$
        pass_filenames: false
        stages: [pre-commit]
